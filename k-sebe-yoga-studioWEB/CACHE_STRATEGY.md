# Кеширование и версии

## Что кешируется

- **Навигация**: сеть → кеш (fallback на кеш при ошибке сети).
- **Статические файлы** (JS/CSS/изображения, запрошенные в том же домене): кеш →
  сеть.
- **Базовые ресурсы**: `/` и `/index.html` сохраняются в `ksebe-static-<версия>`
  во время установки service worker.

Логика находится в `public/sw.js`.

## Стратегия версионирования

- Версия кеша задаётся в `CACHE_VERSION` внутри `public/sw.js`.
- При изменении версии кеша старые кеши удаляются на этапе `activate`.
- После деплоя новой версии приложение уведомляет пользователя, что доступно
  обновление.

## Когда обновлять версию

- При каждом релизе, влияющем на критические ресурсы (JS/CSS/HTML/контент).
- При изменении логики кеширования.

## Как происходит cache bust

1. Увеличить `CACHE_VERSION` в `public/sw.js`.
2. Задеплоить сборку.
3. После установки нового service worker пользователи получат уведомление
   «Доступно обновление».
4. Нажатие «Обновить» перезапустит приложение с новой версией кеша.
